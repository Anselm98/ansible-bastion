# Auditd configuration - Managed by Ansible

# Log file location
log_file = /var/log/audit/audit.log

# Log file format (RAW or ENRICHED)
log_format = RAW

# Log group permission
log_group = root

# Priority for writing to log
priority_boost = 4

# Flush mode (none, incremental, incremental_async, data, sync)
flush = incremental_async

# Frequency to sync file system buffers to disk (0 = never)
freq = 50

# Maximum number of audit log files
num_logs = {{ auditd_num_logs | default('5') }}

# Action to take when log file reaches max size
disp_qos = lossy

# Dispatcher program
dispatcher = /sbin/audispd

# Name format for computer name in records
name_format = none

# Maximum log file size in MB
max_log_file = {{ auditd_max_log_file | default('50') }}

# Action when log file reaches max size
max_log_file_action = {{ auditd_max_log_file_action | default('rotate') }}

# Action when space is low
space_left = {{ auditd_space_left | default('75') }}
space_left_action = {{ auditd_space_left_action | default('syslog') }}

# Action when no space left
admin_space_left = {{ auditd_admin_space_left | default('50') }}
admin_space_left_action = {{ auditd_admin_space_left_action | default('suspend') }}

# Action when disk full
disk_full_action = {{ auditd_disk_full_action | default('suspend') }}

# Action when disk error occurs
disk_error_action = {{ auditd_disk_error_action | default('suspend') }}

# Use libwrap for connections
use_libwrap = yes

# TCP listen port (for remote logging)
tcp_listen_port = {{ auditd_tcp_port | default('60') }}

# TCP listen queue depth
tcp_listen_queue = 5

# TCP max connections
tcp_max_per_addr = 1

# Client max idle time
tcp_client_max_idle = 0

# Enable kerberos authentication
enable_krb5 = no

# Set kerberos principal
krb5_principal = auditd 